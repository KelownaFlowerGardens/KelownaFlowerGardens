<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Reset Password</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:system-ui;
  background:#FDD7D7;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.card{
  background:white;
  padding:2rem;
  border-radius:14px;
  max-width:420px;
  width:100%;
}
h2{ color:#F68686; text-align:center; }
input,button{
  width:100%;
  padding:.75rem;
  margin-top:1rem;
  border-radius:10px;
}
button{
  background:#F68686;
  border:none;
  color:white;
}
.msg{
  text-align:center;
  margin-top:1rem;
}
</style>
</head>

<body>

<div class="card">
  <h2>Reset Password</h2>

  
<form id="newPassForm">
  <input
    type="password"
    id="newPassword"
    placeholder="New password"
    required
  >

   <form id="newPassForm">
    <input type="password" id="pass1" placeholder="New password" required>
    <input type="password" id="pass2" placeholder="Confirm password" required>
    <button type="submit">Update Password</button>
  </form>

  <div class="error" id="error"></div>
</div>

<script>
const token = new URLSearchParams(window.location.search).get("token");

document.getElementById("newPassForm").addEventListener("submit", async e => {
  e.preventDefault();

  const p1 = pass1.value;
  const p2 = pass2.value;

  if (p1 !== p2 || p1.length < 8) {
    error.textContent = "Passwords must match and be at least 8 characters.";
    return;
  }

  const res = await fetch("http://localhost:3000/api/reset-password", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    credentials:"include",
    body:JSON.stringify({ token, password:p1 })
  });

  if (res.ok) {
    // ðŸ”¥ AUTO LOGIN COMPLETE
    window.location.href = "MembersDashboard.html";
  } else {
    error.textContent = "Reset link expired or invalid.";
  }
});
</script>
</body>
</html>
